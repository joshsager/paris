<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Display a map on a webpage</title>
<meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
<link href="https://api.mapbox.com/mapbox-gl-js/v3.2.0/mapbox-gl.css" rel="stylesheet">
<script src="https://api.mapbox.com/mapbox-gl-js/v3.2.0/mapbox-gl.js"></script>
<style>
body { margin: 0; padding: 0; }
#map { position: absolute; top: 0; bottom: 0; width: 100%; }
.mapboxgl-popup-content{width:250px;}
</style>
<script src="https://player.vimeo.com/api/player.js"></script>

</head>
<body>
<div id="map"></div>
<script>
	// TO MAKE THE MAP APPEAR YOU MUST
	// ADD YOUR ACCESS TOKEN FROM
	// https://account.mapbox.com
  mapboxgl.accessToken = 'pk.eyJ1IjoidmlhYmxlaW5kdXN0cmllcyIsImEiOiJja2t4Ynl1aHYxeGxrMnBxbXdrOG51OTIyIn0.govNx4ComMd7D4GHGmz7-w';
    const map = new mapboxgl.Map({
        style: 'mapbox://styles/mapbox/light-v11',
        container: 'map', // container ID
        center: [2.3642363316111683, 48.8264658076551], // starting position [lng, lat]
        zoom: 15.5, // starting zoom
        pitch: 45,
        bearing: -17.6,
        container: 'map',
        antialias: true
    });

    map.addControl(new mapboxgl.NavigationControl());


    map.on('load', () => {

      // Insert the layer beneath any symbol layer.
      const layers = map.getStyle().layers;
        const labelLayerId = layers.find(
            (layer) => layer.type === 'symbol' && layer.layout['text-field']
        ).id;

        // The 'building' layer in the Mapbox Streets
        // vector tileset contains building height data
        // from OpenStreetMap.
        map.addLayer(
            {
                'id': 'add-3d-buildings',
                'source': 'composite',
                'source-layer': 'building',
                'filter': ['==', 'extrude', 'true'],
                'type': 'fill-extrusion',
                'minzoom': 15,
                'paint': {
                    'fill-extrusion-color': '#aaa',

                    // Use an 'interpolate' expression to
                    // add a smooth transition effect to
                    // the buildings as the user zooms in.
                    'fill-extrusion-height': [
                        'interpolate',
                        ['linear'],
                        ['zoom'],
                        15,
                        0,
                        15.05,
                        ['get', 'height']
                    ],
                    'fill-extrusion-base': [
                        'interpolate',
                        ['linear'],
                        ['zoom'],
                        15,
                        0,
                        15.05,
                        ['get', 'min_height']
                    ],
                    'fill-extrusion-opacity': 0.6
                }
            },
            labelLayerId
        );

      // ADD LOCATIONS SOURCE
      map.addSource('locations',{
          'type':'geojson',
          'data':{
            'type':'FeatureCollection',
            'features':[
              {
                'type':'Feature',
                'geometry':{
                    'type':'Point',
                    'coordinates':[2.3642363316111683, 48.8264658076551]
                },
                'properties':{
                  'description':'The following are videos about the Asian Quarter in Paris.',
                  'title':'Triangle De Choisy'
                  
                }
              }
            ]

          }
        }
      )
      // END LOCATIONS SOURCE

      // ADD LOCATIONS LAYER
      map.addLayer({
        'id': 'location_points',
        'type': 'circle',
        'source': 'locations',
        'paint': {
            'circle-radius': 10,
            'circle-color': '#B42222'
          },
          'filter': ['==', '$type', 'Point']
        });
      // END LOCATIONS LAYER

      // LOCATIONS CLICK
      map.on('click', 'location_points', (e) => {
        console.log("Clicked", e)
        new mapboxgl.Popup()
        .setLngLat(e.lngLat)
        .setHTML(`
        
        <iframe id="vimeo-player" src="https://player.vimeo.com/video/921089310?autoplay=1&loop=1&autopause=0&playsinline=1" width="640" height="360" allowfullscreen="allowfullscreen" mozallowfullscreen="mozallowfullscreen" msallowfullscreen="msallowfullscreen" oallowfullscreen="oallowfullscreen" webkitallowfullscreen="webkitallowfullscreen" frameborder="0" allow="autoplay; fullscreen; picture-in-picture" allowfullscreen></iframe>
<p><a href="https://vimeo.com/921089310">Dalle des Olympiades</a> from <a href="https://vimeo.com/user207379052">Cheryl Zhang</a> on <a href="https://vimeo.com">Vimeo</a>.</p>
          `
            
          
        )
        .addTo(map);

        var iframe = document.querySelector('#vimeo-player');
        var player = new Vimeo.Player(iframe);

        function requestFullScreen(element) {
    if (element.requestFullscreen) {
        element.requestFullscreen();
    } else if (element.mozRequestFullScreen) {
        element.mozRequestFullScreen(); // Firefox
    } else if (element.webkitRequestFullscreen) {
        element.webkitRequestFullscreen(); // Chrome, Safari and Opera
    } else if (element.msRequestFullscreen) {
        element.msRequestFullscreen(); // IE/Edge
    }
}

var iframeElement = document.querySelector('#vimeo-player');
requestFullScreen(iframeElement); 

// requestFullScreen(document.querySelector('#vimeo-player'))

        // var videoElement = document.getElementById('videoId');    
        // videoElement.webkitRequestFullScreen();
        });
      // END LOCATIONS CLICK


    });
</script>

</body>